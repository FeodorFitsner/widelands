/*
 * Copyright (C) 2006-2014 by the Widelands Development Team
 *
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation; either version 2
 * of the License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
 *
 */

#include <algorithm>
#include <vector>

#define BOOST_AUTO_TEST_MAIN
#define BOOST_TEST_MODULE BaseGeometry
#include <boost/test/unit_test.hpp>

#include "base/rect.h"

// NOCOM(#sirver): remove
BOOST_AUTO_TEST_CASE(test_rectangle_paper_example) {
}

#if 0
namespace {

void check_equal_vectors(std::vector<int> a, std::vector<int> b) {
	std::sort(a.begin(), a.end());
	std::sort(b.begin(), b.end());

	BOOST_REQUIRE_EQUAL(a.size(), b.size());
	for (size_t i = 0; i < a.size(); ++i) {
		BOOST_CHECK_EQUAL(a[i], b[i]);
	}
}

}  // namespace


// Example from the paper.
BOOST_AUTO_TEST_CASE(test_rectangle_paper_example) {
	const FloatRect r0(107, 103, 175 - 107, 151 - 103);
	const FloatRect r1(184, 111, 274 - 184, 197 - 111);
	const FloatRect r2(213, 128, 249 - 213, 176 - 128);

	const auto rv = find_overlapping_rectangles({r0, r1, r2});
	check_equal_vectors({}, rv[0]);
	check_equal_vectors({2}, rv[1]);
	check_equal_vectors({}, rv[2]);
}

// More complex example I came up with.
BOOST_AUTO_TEST_CASE(test_rectangle_intersection) {
	const FloatRect r0(3, 0, 3, 4);
	const FloatRect r1(2, 1, 7, 7);
	const FloatRect r2(6, 5, 2, 2);
	const FloatRect r3(5.5f, 3.5f, 1, 1);
	const FloatRect r4(2, 9, 1, 1);

	const auto rv = find_overlapping_rectangles({r0, r1, r2, r3, r4});

	check_equal_vectors({1, 3}, rv[0]);
	check_equal_vectors({2, 3}, rv[1]);
	check_equal_vectors({}, rv[2]);
	check_equal_vectors({}, rv[3]);
	check_equal_vectors({}, rv[4]);
}

// A random example that was solved with a slow (but hopefully correct) algorithm.
BOOST_AUTO_TEST_CASE(test_rectangle_intersection_random) {
	const std::vector<FloatRect> rects = {
	   FloatRect(0.418155, 0.177508, 0.537258, 0.980585),
	   FloatRect(0.941306, 0.891253, 0.761454, 0.641066),
	   FloatRect(0.516767, 0.935024, 0.877067, 0.727255),
	   FloatRect(0.131357, 0.622219, 0.520819, 0.585391),
	   FloatRect(0.204650, 0.732203, 0.006511, 0.550630),
	   FloatRect(0.091237, 0.132106, 0.675623, 0.357791),
	   FloatRect(0.657710, 0.699606, 0.668665, 0.571523),
	   FloatRect(0.716053, 0.896755, 0.706508, 0.383091),
	   FloatRect(0.849255, 0.056118, 0.280741, 0.157701),
	   FloatRect(0.692919, 0.046653, 0.331695, 0.022189),
	};
	const auto rv = find_overlapping_rectangles(rects);
	check_equal_vectors({1, 2, 3, 5, 6, 7, 8}, rv[0]);
	check_equal_vectors({2, 6, 7}, rv[1]);
	check_equal_vectors({3, 6, 7}, rv[2]);
	check_equal_vectors({4}, rv[3]);
	check_equal_vectors({}, rv[4]);
	check_equal_vectors({}, rv[5]);
	check_equal_vectors({7}, rv[6]);
	check_equal_vectors({}, rv[7]);
	check_equal_vectors({9}, rv[8]);
	check_equal_vectors({}, rv[9]);
}

BOOST_AUTO_TEST_CASE(test_rectangle_intersection_random_huge) {
	const std::vector<FloatRect> rects = {
	   FloatRect(0.6430881664401739, 0.0435292304378309, 0.1774532345715252, 0.3042943188447438),
	   FloatRect(0.1880736921995360, 0.9964437518439588, 0.7432122078063801, 0.0723151861702299),
	   FloatRect(0.1810097076338025, 0.2676147218003349, 0.2152704948667878, 0.8856306427966602),
	   FloatRect(0.0259711463094306, 0.9647320950019798, 0.7068179530763472, 0.5857936160427847),
	   FloatRect(0.9917815488865467, 0.0114823600810811, 0.9166644347072154, 0.1438856353398770),
	   FloatRect(0.5516803340976929, 0.4024344664879727, 0.5419789743103623, 0.0105718359435792),
	   FloatRect(0.7357015374908531, 0.6873519841414460, 0.1387522108240667, 0.4279378828428688),
	   FloatRect(0.9894249578995762, 0.9092865016359389, 0.7115342290162018, 0.5371427390024718),
	   FloatRect(0.5762548540331834, 0.8093432990821795, 0.4912602305859864, 0.9193334666973224),
	   FloatRect(0.2975254200541239, 0.2779600282653651, 0.7991451706706320, 0.2910401976777801),
	   FloatRect(0.0162608030331981, 0.6979120856308582, 0.3603882283949192, 0.2686347770666430),
	   FloatRect(0.8836591329886188, 0.1705108659024974, 0.9177603849973761, 0.1800453726262162),
	   FloatRect(0.0227898012857428, 0.9179700015544857, 0.2315113585589690, 0.8479599004170310),
	   FloatRect(0.1137601911190550, 0.3327874002415200, 0.7432789589678123, 0.0902877990697191),
	   FloatRect(0.2604358518140948, 0.4085688764936702, 0.9496474009671793, 0.9861993089552747),
	   FloatRect(0.5986230115159824, 0.6280422293289539, 0.9187644292181211, 0.2148913882312746),
	   FloatRect(0.0200174042229714, 0.3922579189899675, 0.0584578340181793, 0.3064928527143941),
	   FloatRect(0.0308204779955681, 0.2149670600346650, 0.6220234155651805, 0.3319982228798369),
	   FloatRect(0.4950228056713338, 0.3677825395021992, 0.6862422000572301, 0.3827934095973057),
	   FloatRect(0.4661173270660812, 0.2029204237760864, 0.8498391634943799, 0.5577590279912243),
	   FloatRect(0.8159957255970118, 0.7670141230664258, 0.5737318090310244, 0.3231838863437660),
	   FloatRect(0.4153916826313704, 0.0785114186749046, 0.1430783495243633, 0.3016697196107243),
	   FloatRect(0.7918905434993589, 0.5063125511169719, 0.8933993313815827, 0.7547384634430121),
	   FloatRect(0.2533319768624798, 0.3141930068067689, 0.9575219735093232, 0.3115209319195360),
	   FloatRect(0.7902646111407734, 0.2476796931861379, 0.8488472063463159, 0.4476251955246100),
	   FloatRect(0.3547558780740006, 0.5969895742747826, 0.8196135858331342, 0.1275785876129177),
	   FloatRect(0.1072276326695855, 0.2481401699989102, 0.5738867883517825, 0.0835236731524426),
	   FloatRect(0.8378467191083874, 0.5636470078418642, 0.7023630605317586, 0.9369776085079252),
	   FloatRect(0.2476630952555293, 0.6617690743505517, 0.1971103849451180, 0.5628741681864812),
	   FloatRect(0.4789145811257811, 0.5316651558338700, 0.9751078574463219, 0.6995006547193129),
	   FloatRect(0.5094954996594754, 0.2125568265873475, 0.4041593359858715, 0.7577453121073693),
	   FloatRect(0.3832807676598075, 0.2957034022524220, 0.7476588199473864, 0.3156694810458354),
	   FloatRect(0.6598045166209854, 0.7413746796827457, 0.4553553056402443, 0.7383881313657683),
	   FloatRect(0.9219968259180099, 0.3034890105172960, 0.1680618634180386, 0.7170629944558903),
	   FloatRect(0.2100277579289378, 0.5861744298166015, 0.9394275691009703, 0.8118168835039660),
	   FloatRect(0.9604560957910471, 0.9396601416127300, 0.3495761048287486, 0.6299135994461819),
	   FloatRect(0.0900938115375716, 0.5266889005537466, 0.4982010485439806, 0.1342976714937711),
	   FloatRect(0.3332728468194220, 0.8795034981679293, 0.2692014759907350, 0.8162411442256349),
	   FloatRect(0.6318504404640940, 0.8432616893440985, 0.4532683791357004, 0.0674761410561292),
	   FloatRect(0.5694357739711374, 0.7622392293685187, 0.0929624468653231, 0.1961597313256944),
	   FloatRect(0.5947631983874814, 0.1211987500241832, 0.5635389427433894, 0.5929637934250075),
	   FloatRect(0.2884914696665857, 0.6466491298492946, 0.8302226888376888, 0.7427568573724599),
	   FloatRect(0.1987205547762794, 0.4154444690561419, 0.2440849700366611, 0.3074042653397067),
	   FloatRect(0.0100213277923461, 0.0067678441923205, 0.0594455952815368, 0.5688401294065192),
	   FloatRect(0.8015704033936096, 0.0846099161784973, 0.4842208996336890, 0.1825092843263384),
	   FloatRect(0.7412018430590361, 0.1424297742979104, 0.7275874416422242, 0.5979716740842240),
	   FloatRect(0.2910381724334442, 0.7185392604742966, 0.2885851594493649, 0.5040798716814868),
	   FloatRect(0.0101133509962592, 0.8858043099947269, 0.4641974107678180, 0.4933874829614219),
	   FloatRect(0.3300008110067978, 0.0094715062481961, 0.3867440246758793, 0.7028747407300043),
	   FloatRect(0.0445594680624433, 0.3345691698024965, 0.6431865584606746, 0.8398719475566695),
	   FloatRect(0.6249997428405311, 0.4152316831937000, 0.8145138710567864, 0.7328046362871554),
	   FloatRect(0.9873578055962241, 0.5539055587360726, 0.0513367853642152, 0.2069842769883953),
	   FloatRect(0.6547145917994130, 0.0598196546385500, 0.7345043962410175, 0.5961938697415395),
	   FloatRect(0.4415913080876731, 0.1244072311377474, 0.2338664504819090, 0.2365624928982366),
	   FloatRect(0.7251550988250124, 0.4260080455096326, 0.6605229619126856, 0.0917570433451288),
	   FloatRect(0.1716141429434697, 0.1119674195105923, 0.4845563898297025, 0.9439471540285079),
	   FloatRect(0.9486804987575066, 0.7440167509870156, 0.4673396181655489, 0.1904253379793062),
	   FloatRect(0.3641395786643685, 0.0803791848729628, 0.1793293614892241, 0.9488455751028237),
	   FloatRect(0.7860028894399190, 0.7208631047691528, 0.7964213315751710, 0.2635787378712600),
	   FloatRect(0.4156356233720825, 0.2658607999199102, 0.0714821231146632, 0.8902997225882685),
	   FloatRect(0.6449998289449287, 0.8527908157135748, 0.7691959218488521, 0.0355755793334180),
	   FloatRect(0.7001754723644172, 0.4097717139124240, 0.9753353771521051, 0.0091608248438808),
	   FloatRect(0.3707287403615904, 0.7232006494464122, 0.3271846727964121, 0.5824021222690646),
	   FloatRect(0.4612810986638036, 0.6010151695363983, 0.0243855037943306, 0.3524512458211163),
	   FloatRect(0.7913462081350177, 0.6959208103986115, 0.5560748474206978, 0.8391986161307408),
	   FloatRect(0.7053188458901760, 0.3047675331243936, 0.3589016045288476, 0.8367486664076209),
	   FloatRect(0.0385195588809636, 0.7261545116067444, 0.3523697403347975, 0.3277214792013786),
	   FloatRect(0.0804993650858326, 0.6495606378246526, 0.4165570644908588, 0.9429897176761707),
	   FloatRect(0.3048545235921432, 0.6549053250307144, 0.4851230368720257, 0.9525042362735405),
	   FloatRect(0.4404683618402155, 0.2361556653828639, 0.5303677751513064, 0.5650638230549915),
	   FloatRect(0.8651529610371557, 0.5983988589842930, 0.3720026460505993, 0.9006585571640622),
	   FloatRect(0.7080655820922972, 0.1195384718022240, 0.8554643308896601, 0.4892098780577057),
	   FloatRect(0.6569080908949083, 0.3338595638424052, 0.1662650473114710, 0.7365204660103727),
	   FloatRect(0.7147805548177606, 0.6023227900983247, 0.0572900805123763, 0.9600467695172242),
	   FloatRect(0.5446465533054216, 0.9810019254568385, 0.4221209293783394, 0.2961940710365624),
	   FloatRect(0.8268088338512729, 0.0381916727570831, 0.0040856901836858, 0.4945990075191271),
	   FloatRect(0.1870993531308777, 0.4489184536048081, 0.2401982070595848, 0.3040692566495747),
	   FloatRect(0.0042693164467676, 0.3197643470152068, 0.3100285812434913, 0.3468760315277686),
	   FloatRect(0.7782454260605981, 0.4473701664580971, 0.3285470756619085, 0.5790100420364335),
	   FloatRect(0.4788243522522194, 0.5347949027389012, 0.8717022925040995, 0.4224310522084309),
	   FloatRect(0.3142228996005172, 0.2170720441925275, 0.9386306910015464, 0.6582817992835303),
	   FloatRect(0.4385699392779646, 0.2829852886414018, 0.0261727619676055, 0.4470989163957998),
	   FloatRect(0.9842617141008293, 0.6701383482408144, 0.8220642280290948, 0.4256617245668068),
	   FloatRect(0.5767850352514757, 0.4745571951965133, 0.6094550259516469, 0.7807731912219535),
	   FloatRect(0.0150847399364542, 0.8739283879294335, 0.9037429280707349, 0.8412274523791066),
	   FloatRect(0.6270620495886345, 0.1299357724865541, 0.1288844600458996, 0.2678037887263554),
	   FloatRect(0.8220528807655438, 0.3600289607802467, 0.2931069967701281, 0.3431919087342371),
	   FloatRect(0.1870867764253255, 0.7950719283941564, 0.3292723503725888, 0.1909216129331903),
	   FloatRect(0.1014654993896067, 0.5352029503555453, 0.1717534099976522, 0.4403801984809308),
	   FloatRect(0.6951701339313974, 0.0709099908908370, 0.4617109230027897, 0.7351793950912922),
	   FloatRect(0.8015409224974176, 0.5175214197588229, 0.8046770839084356, 0.7276898825168852),
	   FloatRect(0.3729444772599479, 0.1678313002140061, 0.0435007386924672, 0.8264982961203660),
	   FloatRect(0.2574855702347112, 0.1133279974176170, 0.2183213407782568, 0.8546955519606120),
	   FloatRect(0.7284196725493962, 0.5267805360903910, 0.9364071976576293, 0.3239991559542765),
	   FloatRect(0.3766622072402775, 0.4282516456061166, 0.8370718977196085, 0.6027477022428123),
	   FloatRect(0.8448367412056300, 0.8610859388444212, 0.6436962331278734, 0.7344868266694807),
	   FloatRect(0.0270083670102894, 0.2710304585238063, 0.8485272361506482, 0.0661621845036668),
	   FloatRect(0.8166237018379714, 0.4542337711281269, 0.7223922780396965, 0.4446302699975304),
	   FloatRect(0.4097284751166285, 0.7098303859512991, 0.2012233858908091, 0.6197849133540888),
	   FloatRect(0.5476083363028251, 0.4798887621549048, 0.0169093898466285, 0.5549020219767852),
	};

	const auto rv = find_overlapping_rectangles(rects);
	check_equal_vectors({9,
	                     13,
	                     17,
	                     19,
	                     23,
	                     24,
	                     26,
	                     30,
	                     31,
	                     40,
	                     44,
	                     45,
	                     48,
	                     49,
	                     52,
	                     53,
	                     55,
	                     65,
	                     69,
	                     71,
	                     72,
	                     80,
	                     85,
	                     89,
	                     96},
	                    rv[0]);
	check_equal_vectors({2,
	                     3,
	                     6,
	                     8,
	                     12,
	                     14,
	                     20,
	                     22,
	                     27,
	                     28,
	                     29,
	                     32,
	                     33,
	                     34,
	                     37,
	                     41,
	                     46,
	                     47,
	                     49,
	                     50,
	                     55,
	                     57,
	                     59,
	                     62,
	                     64,
	                     65,
	                     66,
	                     67,
	                     68,
	                     70,
	                     72,
	                     73,
	                     74,
	                     78,
	                     83,
	                     84,
	                     90,
	                     94,
	                     95,
	                     98,
	                     99},
	                    rv[1]);
	check_equal_vectors({3,
	                     9,
	                     10,
	                     12,
	                     13,
	                     14,
	                     17,
	                     23,
	                     25,
	                     26,
	                     28,
	                     31,
	                     34,
	                     36,
	                     37,
	                     41,
	                     42,
	                     46,
	                     47,
	                     48,
	                     49,
	                     55,
	                     57,
	                     62,
	                     66,
	                     67,
	                     68,
	                     76,
	                     77,
	                     80,
	                     84,
	                     87,
	                     88,
	                     91,
	                     92,
	                     94,
	                     96},
	                    rv[2]);
	check_equal_vectors({8,
	                     10,
	                     12,
	                     14,
	                     28,
	                     29,
	                     30,
	                     32,
	                     34,
	                     37,
	                     41,
	                     46,
	                     47,
	                     49,
	                     50,
	                     55,
	                     57,
	                     59,
	                     62,
	                     65,
	                     66,
	                     67,
	                     68,
	                     72,
	                     73,
	                     74,
	                     83,
	                     84,
	                     87,
	                     88,
	                     91,
	                     92,
	                     94,
	                     98,
	                     99},
	                    rv[3]);
	check_equal_vectors({71, 40, 44, 45, 52, 89}, rv[4]);
	check_equal_vectors({9,
	                     13,
	                     14,
	                     17,
	                     18,
	                     19,
	                     23,
	                     24,
	                     30,
	                     31,
	                     33,
	                     40,
	                     45,
	                     48,
	                     49,
	                     52,
	                     55,
	                     61,
	                     65,
	                     69,
	                     71,
	                     72,
	                     75,
	                     80,
	                     86,
	                     89},
	                    rv[5]);
	check_equal_vectors({8,
	                     14,
	                     15,
	                     18,
	                     19,
	                     20,
	                     22,
	                     24,
	                     25,
	                     27,
	                     29,
	                     30,
	                     32,
	                     34,
	                     38,
	                     40,
	                     41,
	                     45,
	                     50,
	                     58,
	                     60,
	                     64,
	                     65,
	                     68,
	                     69,
	                     70,
	                     72,
	                     73,
	                     74,
	                     78,
	                     79,
	                     80,
	                     83,
	                     84,
	                     86,
	                     89,
	                     90,
	                     93,
	                     94,
	                     95,
	                     97},
	                    rv[6]);
	check_equal_vectors({8,
	                     14,
	                     20,
	                     22,
	                     27,
	                     29,
	                     32,
	                     33,
	                     34,
	                     35,
	                     38,
	                     41,
	                     50,
	                     56,
	                     58,
	                     64,
	                     65,
	                     70,
	                     78,
	                     79,
	                     82,
	                     83,
	                     90,
	                     94,
	                     95},
	                    rv[7]);
	check_equal_vectors({14,
	                     15,
	                     20,
	                     22,
	                     27,
	                     29,
	                     30,
	                     32,
	                     33,
	                     34,
	                     35,
	                     37,
	                     38,
	                     39,
	                     41,
	                     46,
	                     49,
	                     50,
	                     55,
	                     56,
	                     58,
	                     60,
	                     62,
	                     64,
	                     65,
	                     68,
	                     70,
	                     72,
	                     73,
	                     74,
	                     78,
	                     79,
	                     80,
	                     82,
	                     83,
	                     84,
	                     90,
	                     93,
	                     94,
	                     95,
	                     97,
	                     98},
	                    rv[8]);
	check_equal_vectors({11,
	                     13,
	                     14,
	                     17,
	                     18,
	                     19,
	                     21,
	                     22,
	                     23,
	                     24,
	                     26,
	                     27,
	                     29,
	                     30,
	                     31,
	                     33,
	                     36,
	                     40,
	                     42,
	                     45,
	                     48,
	                     49,
	                     50,
	                     51,
	                     52,
	                     53,
	                     54,
	                     55,
	                     57,
	                     59,
	                     61,
	                     65,
	                     69,
	                     71,
	                     72,
	                     75,
	                     76,
	                     77,
	                     78,
	                     79,
	                     80,
	                     81,
	                     83,
	                     85,
	                     86,
	                     89,
	                     90,
	                     91,
	                     92,
	                     93,
	                     94,
	                     96,
	                     97,
	                     99},
	                    rv[9]);
	check_equal_vectors({12,
	                     14,
	                     16,
	                     25,
	                     28,
	                     34,
	                     37,
	                     41,
	                     42,
	                     46,
	                     47,
	                     48,
	                     49,
	                     55,
	                     57,
	                     62,
	                     66,
	                     67,
	                     68,
	                     76,
	                     80,
	                     84,
	                     87,
	                     88,
	                     91,
	                     92},
	                    rv[10]);
	check_equal_vectors({33, 69, 65, 40, 71, 44, 45, 80, 19, 52, 23, 24, 89, 30, 31}, rv[11]);
	check_equal_vectors({34, 67, 87, 66, 47, 49, 84, 55, 88, 28}, rv[12]);
	check_equal_vectors({14,
	                     17,
	                     18,
	                     19,
	                     21,
	                     23,
	                     24,
	                     30,
	                     31,
	                     40,
	                     42,
	                     45,
	                     48,
	                     49,
	                     50,
	                     52,
	                     53,
	                     55,
	                     57,
	                     59,
	                     61,
	                     65,
	                     69,
	                     71,
	                     72,
	                     75,
	                     77,
	                     80,
	                     81,
	                     85,
	                     86,
	                     89,
	                     91,
	                     92,
	                     96},
	                    rv[13]);
	check_equal_vectors({15,
	                     17,
	                     18,
	                     19,
	                     20,
	                     22,
	                     23,
	                     24,
	                     25,
	                     27,
	                     28,
	                     29,
	                     30,
	                     31,
	                     32,
	                     33,
	                     34,
	                     35,
	                     36,
	                     37,
	                     38,
	                     39,
	                     40,
	                     41,
	                     42,
	                     45,
	                     46,
	                     47,
	                     48,
	                     49,
	                     50,
	                     51,
	                     52,
	                     54,
	                     55,
	                     56,
	                     57,
	                     58,
	                     59,
	                     60,
	                     61,
	                     62,
	                     63,
	                     64,
	                     65,
	                     66,
	                     67,
	                     68,
	                     69,
	                     70,
	                     71,
	                     72,
	                     73,
	                     74,
	                     75,
	                     76,
	                     77,
	                     78,
	                     79,
	                     80,
	                     81,
	                     82,
	                     83,
	                     84,
	                     86,
	                     87,
	                     88,
	                     89,
	                     90,
	                     91,
	                     92,
	                     93,
	                     94,
	                     95,
	                     97,
	                     98,
	                     99},
	                    rv[14]);
	check_equal_vectors({18,
	                     19,
	                     20,
	                     22,
	                     24,
	                     25,
	                     27,
	                     29,
	                     30,
	                     32,
	                     33,
	                     34,
	                     39,
	                     40,
	                     41,
	                     45,
	                     48,
	                     49,
	                     50,
	                     51,
	                     52,
	                     55,
	                     56,
	                     58,
	                     62,
	                     64,
	                     65,
	                     68,
	                     69,
	                     70,
	                     72,
	                     73,
	                     78,
	                     79,
	                     80,
	                     82,
	                     83,
	                     86,
	                     89,
	                     90,
	                     93,
	                     94,
	                     97,
	                     98},
	                    rv[15]);
	check_equal_vectors({17, 43, 77, 49}, rv[16]);
	check_equal_vectors({18,
	                     19,
	                     21,
	                     23,
	                     26,
	                     29,
	                     30,
	                     31,
	                     36,
	                     40,
	                     42,
	                     43,
	                     48,
	                     49,
	                     50,
	                     53,
	                     55,
	                     57,
	                     59,
	                     69,
	                     76,
	                     77,
	                     79,
	                     80,
	                     81,
	                     83,
	                     85,
	                     88,
	                     91,
	                     92,
	                     94,
	                     96,
	                     99},
	                    rv[17]);
	check_equal_vectors({19,
	                     21,
	                     22,
	                     23,
	                     24,
	                     25,
	                     27,
	                     29,
	                     30,
	                     31,
	                     32,
	                     33,
	                     34,
	                     36,
	                     40,
	                     41,
	                     45,
	                     46,
	                     48,
	                     49,
	                     50,
	                     51,
	                     52,
	                     54,
	                     55,
	                     56,
	                     57,
	                     58,
	                     61,
	                     62,
	                     64,
	                     65,
	                     67,
	                     68,
	                     69,
	                     70,
	                     71,
	                     72,
	                     73,
	                     75,
	                     78,
	                     79,
	                     80,
	                     82,
	                     83,
	                     85,
	                     86,
	                     89,
	                     90,
	                     93,
	                     94,
	                     97,
	                     98,
	                     99},
	                    rv[18]);
	check_equal_vectors({21,
	                     22,
	                     23,
	                     24,
	                     25,
	                     26,
	                     27,
	                     29,
	                     30,
	                     31,
	                     32,
	                     33,
	                     34,
	                     36,
	                     40,
	                     41,
	                     44,
	                     45,
	                     46,
	                     48,
	                     49,
	                     50,
	                     51,
	                     52,
	                     53,
	                     54,
	                     55,
	                     56,
	                     57,
	                     58,
	                     59,
	                     61,
	                     62,
	                     63,
	                     64,
	                     65,
	                     67,
	                     68,
	                     69,
	                     70,
	                     71,
	                     72,
	                     73,
	                     75,
	                     78,
	                     79,
	                     80,
	                     82,
	                     83,
	                     85,
	                     86,
	                     89,
	                     90,
	                     92,
	                     93,
	                     94,
	                     96,
	                     97,
	                     98,
	                     99},
	                    rv[19]);
	check_equal_vectors({22,
	                     27,
	                     29,
	                     30,
	                     32,
	                     33,
	                     34,
	                     35,
	                     38,
	                     41,
	                     50,
	                     56,
	                     58,
	                     60,
	                     64,
	                     65,
	                     69,
	                     70,
	                     72,
	                     74,
	                     78,
	                     79,
	                     80,
	                     82,
	                     83,
	                     84,
	                     89,
	                     90,
	                     93,
	                     94,
	                     95,
	                     97},
	                    rv[20]);
	check_equal_vectors({96, 80, 91, 69, 81, 55, 48, 49, 53, 23, 57, 26, 59, 92, 30, 31}, rv[21]);
	check_equal_vectors({23,
	                     24,
	                     25,
	                     27,
	                     29,
	                     30,
	                     31,
	                     32,
	                     33,
	                     34,
	                     35,
	                     38,
	                     40,
	                     41,
	                     45,
	                     50,
	                     51,
	                     52,
	                     54,
	                     56,
	                     58,
	                     60,
	                     64,
	                     65,
	                     69,
	                     70,
	                     71,
	                     72,
	                     74,
	                     75,
	                     78,
	                     79,
	                     80,
	                     82,
	                     83,
	                     84,
	                     86,
	                     89,
	                     90,
	                     93,
	                     94,
	                     95,
	                     97},
	                    rv[22]);
	check_equal_vectors({24,
	                     25,
	                     26,
	                     27,
	                     29,
	                     30,
	                     31,
	                     33,
	                     34,
	                     36,
	                     40,
	                     42,
	                     45,
	                     48,
	                     49,
	                     50,
	                     51,
	                     52,
	                     53,
	                     54,
	                     55,
	                     57,
	                     59,
	                     61,
	                     63,
	                     65,
	                     69,
	                     70,
	                     71,
	                     72,
	                     73,
	                     75,
	                     76,
	                     77,
	                     78,
	                     79,
	                     80,
	                     81,
	                     83,
	                     85,
	                     86,
	                     88,
	                     89,
	                     90,
	                     91,
	                     92,
	                     93,
	                     94,
	                     96,
	                     97,
	                     99},
	                    rv[23]);
	check_equal_vectors({25,
	                     27,
	                     29,
	                     30,
	                     31,
	                     33,
	                     34,
	                     40,
	                     41,
	                     44,
	                     45,
	                     50,
	                     51,
	                     52,
	                     54,
	                     61,
	                     65,
	                     69,
	                     70,
	                     71,
	                     72,
	                     75,
	                     78,
	                     79,
	                     80,
	                     82,
	                     83,
	                     86,
	                     89,
	                     90,
	                     93,
	                     94,
	                     96,
	                     97},
	                    rv[24]);
	check_equal_vectors({27,
	                     28,
	                     29,
	                     30,
	                     31,
	                     33,
	                     34,
	                     36,
	                     40,
	                     41,
	                     42,
	                     45,
	                     46,
	                     48,
	                     49,
	                     50,
	                     51,
	                     52,
	                     55,
	                     57,
	                     58,
	                     59,
	                     62,
	                     63,
	                     64,
	                     65,
	                     67,
	                     68,
	                     69,
	                     70,
	                     71,
	                     72,
	                     73,
	                     76,
	                     78,
	                     79,
	                     80,
	                     81,
	                     82,
	                     83,
	                     86,
	                     89,
	                     90,
	                     91,
	                     92,
	                     93,
	                     94,
	                     97,
	                     98,
	                     99},
	                    rv[25]);
	check_equal_vectors({96, 80, 91, 69, 40, 77, 48, 81, 52, 53, 55, 57, 85, 59,
			92, 30, 31}, rv[26]);
	check_equal_vectors({29,
	                     30,
	                     31,
	                     32,
	                     33,
	                     34,
	                     35,
	                     38,
	                     40,
	                     41,
	                     45,
	                     50,
	                     51,
	                     52,
	                     56,
	                     58,
	                     60,
	                     64,
	                     65,
	                     69,
	                     70,
	                     71,
	                     74,
	                     78,
	                     79,
	                     80,
	                     82,
	                     83,
	                     84,
	                     86,
	                     89,
	                     90,
	                     93,
	                     94,
	                     95,
	                     97},
	                    rv[27]);
	check_equal_vectors({34,
	                     37,
	                     41,
	                     42,
	                     46,
	                     47,
	                     48,
	                     49,
	                     55,
	                     57,
	                     59,
	                     62,
	                     66,
	                     67,
	                     68,
	                     69,
	                     76,
	                     77,
	                     80,
	                     81,
	                     84,
	                     87,
	                     88,
	                     91,
	                     92,
	                     94,
	                     98},
	                    rv[28]);
	check_equal_vectors({30,
	                     31,
	                     32,
	                     33,
	                     34,
	                     35,
	                     36,
	                     37,
	                     38,
	                     39,
	                     40,
	                     41,
	                     45,
	                     46,
	                     48,
	                     49,
	                     50,
	                     51,
	                     52,
	                     55,
	                     56,
	                     57,
	                     58,
	                     59,
	                     60,
	                     62,
	                     63,
	                     64,
	                     65,
	                     67,
	                     68,
	                     69,
	                     70,
	                     71,
	                     72,
	                     73,
	                     74,
	                     75,
	                     78,
	                     79,
	                     80,
	                     82,
	                     83,
	                     84,
	                     86,
	                     87,
	                     89,
	                     90,
	                     93,
	                     94,
	                     95,
	                     97,
	                     98,
	                     99},
	                    rv[29]);
	check_equal_vectors({31,
	                     32,
	                     34,
	                     36,
	                     37,
	                     38,
	                     39,
	                     40,
	                     41,
	                     44,
	                     45,
	                     46,
	                     48,
	                     49,
	                     50,
	                     52,
	                     53,
	                     54,
	                     55,
	                     57,
	                     58,
	                     60,
	                     61,
	                     62,
	                     64,
	                     65,
	                     68,
	                     69,
	                     70,
	                     71,
	                     72,
	                     73,
	                     75,
	                     78,
	                     79,
	                     80,
	                     83,
	                     84,
	                     85,
	                     86,
	                     87,
	                     89,
	                     90,
	                     93,
	                     94,
	                     95,
	                     96,
	                     97,
	                     98,
	                     99},
	                    rv[30]);
	check_equal_vectors({33,
	                     34,
	                     36,
	                     40,
	                     42,
	                     45,
	                     48,
	                     49,
	                     50,
	                     51,
	                     52,
	                     53,
	                     54,
	                     55,
	                     57,
	                     59,
	                     61,
	                     63,
	                     65,
	                     69,
	                     70,
	                     71,
	                     72,
	                     73,
	                     75,
	                     76,
	                     78,
	                     79,
	                     80,
	                     81,
	                     83,
	                     85,
	                     86,
	                     89,
	                     90,
	                     91,
	                     92,
	                     93,
	                     94,
	                     96,
	                     97,
	                     99},
	                    rv[31]);
	check_equal_vectors({33,
	                     34,
	                     35,
	                     38,
	                     39,
	                     41,
	                     49,
	                     50,
	                     51,
	                     56,
	                     58,
	                     60,
	                     62,
	                     64,
	                     65,
	                     68,
	                     69,
	                     70,
	                     72,
	                     73,
	                     74,
	                     78,
	                     79,
	                     80,
	                     82,
	                     83,
	                     84,
	                     89,
	                     90,
	                     93,
	                     94,
	                     95,
	                     97},
	                    rv[32]);
	check_equal_vectors({34,
	                     35,
	                     38,
	                     40,
	                     41,
	                     45,
	                     50,
	                     51,
	                     52,
	                     54,
	                     56,
	                     58,
	                     60,
	                     61,
	                     64,
	                     65,
	                     69,
	                     70,
	                     71,
	                     74,
	                     78,
	                     79,
	                     80,
	                     82,
	                     83,
	                     86,
	                     89,
	                     90,
	                     93,
	                     94,
	                     95,
	                     97},
	                    rv[33]);
	check_equal_vectors({35,
	                     36,
	                     37,
	                     38,
	                     39,
	                     40,
	                     41,
	                     42,
	                     45,
	                     46,
	                     47,
	                     48,
	                     49,
	                     50,
	                     51,
	                     52,
	                     55,
	                     56,
	                     57,
	                     58,
	                     59,
	                     60,
	                     62,
	                     63,
	                     64,
	                     65,
	                     66,
	                     67,
	                     68,
	                     69,
	                     70,
	                     71,
	                     72,
	                     73,
	                     74,
	                     76,
	                     77,
	                     78,
	                     79,
	                     80,
	                     81,
	                     82,
	                     83,
	                     84,
	                     86,
	                     87,
	                     88,
	                     89,
	                     90,
	                     91,
	                     92,
	                     93,
	                     94,
	                     95,
	                     97,
	                     98,
	                     99},
	                    rv[34]);
	check_equal_vectors({64, 65, 70, 41, 74, 82, 78, 79, 50, 83, 58, 90, 94, 95}, rv[35]);
	check_equal_vectors({41, 42, 48, 49, 55, 57, 59, 63, 67, 68, 69, 76, 77, 79,
			80, 81, 83, 88, 91, 92, 94, 99},
	   rv[36]);
	check_equal_vectors({39, 41, 46, 47, 49, 55, 57, 59, 62, 63, 66, 67, 68, 74,
			79, 83, 84, 87, 91, 92, 94, 98, 99},
	   rv[37]);
	check_equal_vectors({39,
	                     41,
	                     49,
	                     50,
	                     55,
	                     56,
	                     58,
	                     60,
	                     62,
	                     64,
	                     65,
	                     68,
	                     70,
	                     72,
	                     73,
	                     78,
	                     79,
	                     80,
	                     82,
	                     83,
	                     84,
	                     90,
	                     93,
	                     94,
	                     95,
	                     97},
	                    rv[38]);
	check_equal_vectors({98, 68, 69, 72, 41, 46, 79, 80, 49, 50, 83, 84, 94, 55, 60, 62}, rv[39]);
	check_equal_vectors({41,
	                     44,
	                     45,
	                     48,
	                     49,
	                     50,
	                     51,
	                     52,
	                     53,
	                     54,
	                     55,
	                     61,
	                     64,
	                     65,
	                     68,
	                     69,
	                     70,
	                     71,
	                     72,
	                     73,
	                     75,
	                     78,
	                     79,
	                     80,
	                     82,
	                     83,
	                     85,
	                     86,
	                     89,
	                     90,
	                     93,
	                     94,
	                     96,
	                     97,
	                     98},
	                    rv[40]);
	check_equal_vectors({42,
	                     45,
	                     46,
	                     47,
	                     48,
	                     49,
	                     50,
	                     51,
	                     52,
	                     55,
	                     56,
	                     57,
	                     58,
	                     59,
	                     60,
	                     62,
	                     63,
	                     64,
	                     65,
	                     66,
	                     67,
	                     68,
	                     69,
	                     70,
	                     72,
	                     73,
	                     74,
	                     76,
	                     77,
	                     78,
	                     79,
	                     80,
	                     81,
	                     82,
	                     83,
	                     84,
	                     86,
	                     87,
	                     89,
	                     90,
	                     91,
	                     92,
	                     93,
	                     94,
	                     95,
	                     97,
	                     98,
	                     99},
	                    rv[41]);
	check_equal_vectors({80, 98, 67, 68, 69, 81, 76, 77, 46, 48, 49, 91, 55, 88,
			57, 59, 92, 94}, rv[42]);
	check_equal_vectors({96, 49, 77}, rv[43]);
	check_equal_vectors({69, 71, 75, 45, 80, 52, 89}, rv[44]);
	check_equal_vectors({50,
	                     51,
	                     52,
	                     54,
	                     58,
	                     61,
	                     64,
	                     65,
	                     68,
	                     69,
	                     70,
	                     71,
	                     72,
	                     73,
	                     75,
	                     78,
	                     79,
	                     80,
	                     82,
	                     83,
	                     85,
	                     86,
	                     89,
	                     90,
	                     93,
	                     94,
	                     96,
	                     97},
	                    rv[45]);
	check_equal_vectors({47,
	                     49,
	                     55,
	                     57,
	                     59,
	                     62,
	                     63,
	                     66,
	                     67,
	                     68,
	                     69,
	                     74,
	                     76,
	                     79,
	                     80,
	                     81,
	                     83,
	                     84,
	                     87,
	                     91,
	                     92,
	                     94,
	                     98,
	                     99},
	                    rv[46]);
	check_equal_vectors({66, 67, 68, 87, 98, 49, 91, 84, 94, 55, 88, 57, 59, 92, 62, 63}, rv[47]);
	check_equal_vectors({49,
	                     50,
	                     52,
	                     53,
	                     55,
	                     57,
	                     59,
	                     61,
	                     63,
	                     65,
	                     67,
	                     68,
	                     69,
	                     71,
	                     72,
	                     73,
	                     76,
	                     79,
	                     80,
	                     81,
	                     83,
	                     85,
	                     89,
	                     91,
	                     92,
	                     94,
	                     96,
	                     98,
	                     99},
	                    rv[48]);
	check_equal_vectors({50,
	                     52,
	                     53,
	                     55,
	                     57,
	                     59,
	                     60,
	                     62,
	                     63,
	                     66,
	                     67,
	                     68,
	                     69,
	                     72,
	                     74,
	                     76,
	                     77,
	                     79,
	                     80,
	                     81,
	                     83,
	                     84,
	                     85,
	                     87,
	                     88,
	                     91,
	                     92,
	                     94,
	                     96,
	                     98,
	                     99},
	                    rv[49]);
	check_equal_vectors({51,
	                     52,
	                     54,
	                     55,
	                     56,
	                     58,
	                     60,
	                     61,
	                     62,
	                     64,
	                     65,
	                     68,
	                     69,
	                     70,
	                     71,
	                     72,
	                     73,
	                     74,
	                     75,
	                     78,
	                     79,
	                     80,
	                     82,
	                     83,
	                     84,
	                     86,
	                     89,
	                     90,
	                     93,
	                     94,
	                     95,
	                     97},
	                    rv[50]);
	check_equal_vectors({64, 65, 93, 70, 71, 78, 79, 80, 82, 83, 52, 97, 86, 56,
			89, 58, 90, 94}, rv[51]);
	check_equal_vectors({53,
	                     54,
	                     55,
	                     61,
	                     65,
	                     68,
	                     69,
	                     70,
	                     71,
	                     72,
	                     73,
	                     75,
	                     78,
	                     79,
	                     80,
	                     83,
	                     85,
	                     86,
	                     89,
	                     90,
	                     93,
	                     94,
	                     96,
	                     97},
	                    rv[52]);
	check_equal_vectors({96, 69, 72, 80, 81, 85, 55, 57, 59, 92}, rv[53]);
	check_equal_vectors({65, 97, 69, 71, 72, 75, 78, 80, 83, 86, 89, 90, 94}, rv[54]);
	check_equal_vectors({57,
	                     59,
	                     60,
	                     62,
	                     63,
	                     66,
	                     67,
	                     68,
	                     69,
	                     74,
	                     76,
	                     77,
	                     79,
	                     80,
	                     81,
	                     83,
	                     84,
	                     85,
	                     87,
	                     88,
	                     91,
	                     92,
	                     94,
	                     96,
	                     98,
	                     99},
	                    rv[55]);
	check_equal_vectors({64, 65, 97, 69, 70, 93, 78, 79, 80, 82, 83, 89, 58, 60,
			90, 94, 95}, rv[56]);
	check_equal_vectors({96, 66, 67, 68, 69, 76, 98, 79, 80, 81, 91, 84, 94, 87,
			59, 92, 62, 63}, rv[57]);
	check_equal_vectors({64, 65, 68, 69, 70, 97, 72, 74, 78, 79, 80, 82, 83,
			84, 89, 90, 60, 93, 94, 95}, rv[58]);
	check_equal_vectors({96, 98, 67, 68, 69, 76, 79, 80, 81, 84, 94, 87, 91, 92, 62, 63}, rv[59]);
	check_equal_vectors({64, 65, 68, 70, 97, 72, 73, 78, 79, 80, 82, 83, 84, 94,
			90, 62, 95}, rv[60]);
	check_equal_vectors({65, 69, 71, 72, 75, 80, 86, 89}, rv[61]);
	check_equal_vectors({66, 67, 68, 69, 72, 74, 76, 98, 79, 80, 81, 83, 84, 99,
			87, 89, 91, 92, 94, 63}, rv[62]);
	check_equal_vectors({98, 67, 68, 69, 79, 80, 81, 84, 87, 92, 94}, rv[63]);
	check_equal_vectors({65, 69, 70, 97, 72, 74, 78, 79, 80, 82, 83, 84, 86, 89,
			90, 93, 94, 95}, rv[64]);
	check_equal_vectors({68, 69, 70, 71, 72, 73, 74, 75, 78, 79, 80, 82, 83, 84,
			85, 86, 89, 90, 93, 94, 95, 96, 97},
	   rv[65]);
	check_equal_vectors({67, 68, 76, 80, 84, 87, 88, 91, 92, 94}, rv[66]);
	check_equal_vectors({98, 68, 69, 76, 77, 79, 80, 81, 84, 87, 88, 91, 92, 94}, rv[67]);
	check_equal_vectors({98, 99, 69, 72, 73, 74, 76, 77, 78, 79, 80, 81, 83, 84,
			87, 89, 91, 92, 93, 94}, rv[68]);
	check_equal_vectors({70, 71, 72, 73, 75, 78, 79, 80, 81, 83, 85, 86, 87, 89,
			90, 92, 93, 94, 96, 97, 98, 99},
	   rv[69]);
	check_equal_vectors({97, 71, 74, 78, 79, 80, 82, 83, 84, 86, 89, 90, 93, 94, 95}, rv[70]);
	check_equal_vectors({96, 97, 72, 73, 75, 78, 79, 80, 83, 85, 86, 89, 90, 93, 94}, rv[71]);
	check_equal_vectors({96, 97, 73, 74, 78, 79, 80, 83, 84, 85, 86, 89, 90, 93, 94}, rv[72]);
	check_equal_vectors({74, 79, 80, 83, 84, 89, 93, 94}, rv[73]);
	check_equal_vectors({98, 99, 78, 83, 84, 90, 94, 95}, rv[74]);
	check_equal_vectors({96, 97, 78, 80, 83, 86, 89, 90, 93, 94}, rv[75]);
	check_equal_vectors({98, 77, 80, 88, 91, 92, 94}, rv[76]);
	check_equal_vectors({80, 88, 92, 96}, rv[77]);
	check_equal_vectors({97, 79, 80, 82, 83, 84, 86, 89, 90, 93, 94, 95}, rv[78]);
	check_equal_vectors({97, 98, 99, 80, 82, 83, 84, 86, 87, 89, 90, 93, 94, 95}, rv[79]);
	check_equal_vectors({96, 97, 98, 99, 81, 82, 83, 84, 85, 86, 87, 89, 90, 91,
			92, 93, 94, 95}, rv[80]);
	check_equal_vectors({96, 98, 92, 94}, rv[81]);
	check_equal_vectors({97, 83, 86, 89, 90, 93, 94, 95}, rv[82]);
	check_equal_vectors({97, 98, 84, 86, 89, 90, 93, 94, 95}, rv[83]);
	check_equal_vectors({97, 98, 99, 87, 88, 90, 91, 92, 94, 95}, rv[84]);
	check_equal_vectors({96, 89}, rv[85]);
	check_equal_vectors({89, 90, 93, 94, 97}, rv[86]);
	check_equal_vectors({88, 98, 91, 92, 94}, rv[87]);
	check_equal_vectors({92}, rv[88]);
	check_equal_vectors({96, 97, 90, 93, 94}, rv[89]);
	check_equal_vectors({97, 93, 94, 95}, rv[90]);
	check_equal_vectors({96, 98, 92, 94}, rv[91]);
	check_equal_vectors({96, 98, 94}, rv[92]);
	check_equal_vectors({97, 94}, rv[93]);
	check_equal_vectors({97, 98, 99, 95}, rv[94]);
	check_equal_vectors({97}, rv[95]);
	check_equal_vectors({}, rv[96]);
	check_equal_vectors({}, rv[97]);
	check_equal_vectors({99}, rv[98]);
	check_equal_vectors({}, rv[99]);
};
// NOCOM(#sirver): bring backs
#endif
